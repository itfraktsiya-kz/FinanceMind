<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceMind - Умный финансовый помощник</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Уведомления -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Основное приложение -->
    <div class="app-container" id="appContainer">
        <!-- Страница выбора типа аккаунта -->
        <div class="account-type-page" id="accountTypePage">
            <div class="account-type-container">
                <div class="account-type-header">
                    <div class="account-type-logo">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <h1 class="account-title">FinanceMind</h1>
                    <p class="account-subtitle">Выберите тип аккаунта</p>
                </div>

                <div class="account-type-buttons">
                    <div class="account-type-button" onclick="selectAccountType('teen')">
                        <div class="account-button-icon teen">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <div class="account-button-content">
                            <h3>Подросток</h3>
                        </div>
                        <div class="account-button-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>

                    <div class="account-type-button" onclick="selectAccountType('parent')">
                        <div class="account-button-icon parent">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="account-button-content">
                            <h3>Родитель</h3>
                        </div>
                        <div class="account-button-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>

                    <div class="account-type-button" onclick="selectAccountType('adult')">
                        <div class="account-button-icon adult">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="account-button-content">
                            <h3>Взрослый</h3>
                        </div>
                        <div class="account-button-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>

                <div class="account-type-footer">
                    <p>Уже есть аккаунт? <a href="#" onclick="showLoginPage()">Войти</a></p>
                </div>
            </div>
        </div>

        <!-- Страница входа -->
        <div class="auth-page" id="authPage" style="display: none;">
            <div class="auth-container">
                <div class="auth-header">
                    <div class="auth-logo">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <h1 class="auth-title">FinanceMind</h1>
                    <p class="auth-subtitle">Умный финансовый помощник</p>
                </div>

                <div class="auth-form">
                    <div class="form-group floating-label">
                        <input type="email" id="email" class="form-input" placeholder=" " required>
                        <label for="email" class="floating-label-text">Электронная почта</label>
                    </div>
                    
                    <div class="form-group floating-label password-group">
                        <div class="password-input-container">
                            <input type="password" id="password" class="form-input" placeholder=" " required>
                            <label for="password" class="floating-label-text">Пароль</label>
                            <button type="button" class="toggle-password" onclick="togglePasswordVisibility('password')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary login-btn" onclick="login()">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Войти</span>
                    </button>

                    <div class="back-to-selection">
                        <a href="#" onclick="showAccountTypePage()">
                            <i class="fas fa-arrow-left"></i>
                            <span>Назад к выбору типа аккаунта</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- App Header - Only shown after login -->
        <div class="app-header" id="appHeader" style="display: none;">
            <div class="header-content">
                <div class="header-title" id="headerTitle">Главная</div>
                <div class="language-switcher">
                    <button class="lang-btn" onclick="changeLanguage('ru')" data-lang="ru">
                        <span>RU</span>
                    </button>
                    <button class="lang-btn" onclick="changeLanguage('kz')" data-lang="kz">
                        <span>KZ</span>
                    </button>
                    <button class="lang-btn" onclick="changeLanguage('en')" data-lang="en">
                        <span>EN</span>
                    </button>
                </div>
            </div>
            <div class="header-actions">
                <div class="header-icon" onclick="forceSync()" title="Синхронизировать">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div class="header-icon" id="adminButton" onclick="showAdminPanel()" style="display: none;" title="Админ панель">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="header-icon" onclick="showPage('settings')" title="Настройки">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div class="page dashboard active" id="dashboard" style="display: none;">
                <!-- Активная миссия (только для подростков) -->
                <div class="active-mission-banner compact" id="activeMissionBanner" style="display: none;">
                    <div class="active-mission-content">
                        <div class="active-mission-header">
                            <h3>Активная миссия</h3>
                            <button class="btn-icon small" onclick="stopActiveMission()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="active-mission-details">
                            <p id="activeMissionDescription">Описание миссии</p>
                            <div class="active-mission-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="activeMissionProgressFill"></div>
                                </div>
                                <div class="progress-text" id="activeMissionProgressText">0%</div>
                            </div>
                            <div class="active-mission-info">
                                <div class="mission-reward">
                                    <i class="fas fa-coins"></i>
                                    <span id="activeMissionReward">0</span>
                                </div>
                                <div class="mission-difficulty" id="activeMissionDifficulty">Легко</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="user-info compact">
                    <div>
                        <div class="user-greeting" id="userGreeting">Доброе утро!</div>
                        <div class="user-name" id="userName">Пользователь</div>
                        <div class="user-role-badge" id="userRoleBadge">Подросток</div>
                    </div>
                    <div class="user-avatar small" id="userAvatar">П</div>
                </div>

                <!-- AI совет -->
                <div class="ai-advice compact">
                    <div class="ai-icon small">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="ai-content">
                        <div class="ai-title">AI Совет дня</div>
                        <div class="ai-message" id="aiMessage">Начните добавлять расходы, чтобы получить персонализированные советы!</div>
                    </div>
                </div>

                <!-- Кнопка инструкции -->
                <div class="card instruction-card compact" onclick="showInstructionModal()">
                    <div class="card-header">
                        <div class="card-icon small">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3>Инструкция</h3>
                    </div>
                    <p>Руководство по использованию приложения</p>
                </div>

                <!-- Статистика расходов -->
                <div class="section-header compact">
                    <div class="section-title">Ваша статистика</div>
                </div>
                <div class="expense-stats compact" id="expenseStats">
                    <!-- Статистика будет обновляться динамически -->
                </div>

                <!-- Цели -->
                <div class="section-header compact">
                    <div class="section-title">Мои цели</div>
                    <button class="btn-icon small" onclick="openGoalModal()">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="goals-progress compact" id="goalsList">
                    <!-- Цели будут добавляться динамически -->
                </div>
                
                <div id="emptyGoals" class="empty-state compact" style="display: none;">
                    <i class="fas fa-bullseye"></i>
                    <p>У вас пока нет финансовых целей</p>
                    <button class="btn btn-primary small" onclick="openGoalModal()">
                        <i class="fas fa-plus"></i>
                        <span>Добавить</span>
                    </button>
                </div>
            </div>

            <!-- Analytics Page -->
            <div class="page analytics-page" id="analytics" style="display: none;">
                <!-- Кнопки отчетов для пользователя -->
                <div class="reports-section compact">
                    <h3 class="section-title">Отчеты</h3>
                    <div class="reports-grid compact">
                        <div class="report-card compact" onclick="openReportModal('monthly')">
                            <div class="report-icon small">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <div class="report-content">
                                <div class="report-title">Отчет за месяц</div>
                                <div class="report-description">Сводка расходов за текущий месяц</div>
                            </div>
                        </div>
                        
                        <div class="report-card compact" onclick="openReportModal('detailed')">
                            <div class="report-icon small">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="report-content">
                                <div class="report-title">Обширный отчет</div>
                                <div class="report-description">Полная статистика и аналитика</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Инструменты для взрослых -->
                <div class="adult-tools-section compact" id="adultToolsSection" style="display: none;">
                    <h3 class="section-title">Инструменты для взрослых</h3>
                    <div class="adult-tools-grid compact">
                        <div class="adult-tool-card compact" onclick="showBudgetPlanner()">
                            <div class="adult-tool-icon small">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="adult-tool-content">
                                <div class="adult-tool-title">Планировщик бюджета</div>
                            </div>
                        </div>
                        <div class="adult-tool-card compact" onclick="showExpenseAnalysis()">
                            <div class="adult-tool-icon small">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="adult-tool-content">
                                <div class="adult-tool-title">Анализ расходов</div>
                            </div>
                        </div>
                        <div class="adult-tool-card compact" onclick="showBudgetDistribution()">
                            <div class="adult-tool-icon small">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <div class="adult-tool-content">
                                <div class="adult-tool-title">Умное распределение</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Статистика -->
                <div class="expense-stats compact" id="analyticsStats">
                    <!-- Статистика будет обновляться динамически -->
                </div>

                <!-- График расходов -->
                <div class="analytics-chart compact">
                    <h3 class="section-title">Динамика расходов</h3>
                    
                    <div class="chart-type-selector compact">
                        <button class="chart-type-btn active small" onclick="changeChartType('total')" id="totalChartBtn">
                            <i class="fas fa-chart-line"></i>
                            <span>Общие</span>
                        </button>
                        <button class="chart-type-btn small" onclick="changeChartType('categories')" id="categoriesChartBtn">
                            <i class="fas fa-chart-bar"></i>
                            <span>Категории</span>
                        </button>
                    </div>
                    
                    <div class="chart-container compact">
                        <div class="empty-chart compact" id="emptyLineChart">
                            <i class="fas fa-chart-line"></i>
                            <p>Нет данных для отображения</p>
                            <p class="chart-hint">Добавьте расходы, чтобы увидеть график</p>
                        </div>
                        <canvas id="lineChart" style="display: none;"></canvas>
                    </div>
                </div>

                <!-- Круговая диаграмма -->
                <div class="pie-chart-container compact">
                    <h3 class="section-title">Распределение по категориям</h3>
                    <div class="chart-container compact">
                        <div class="empty-chart compact" id="emptyPieChart">
                            <i class="fas fa-chart-pie"></i>
                            <p>Нет данных для отображения</p>
                            <p class="chart-hint">Добавьте расходы, чтобы увидеть график</p>
                        </div>
                        <canvas id="pieChart" style="display: none;"></canvas>
                    </div>
                </div>

                <!-- История расходов -->
                <div class="expense-history compact">
                    <div class="section-header compact">
                        <div class="section-title">Последние расходы</div>
                    </div>
                    <div class="expense-list compact" id="expenseList">
                        <!-- Расходы будут добавляться динамически -->
                    </div>
                    <div id="emptyExpenses" class="empty-state compact" style="display: none;">
                        <i class="fas fa-receipt"></i>
                        <p>У вас пока нет расходов</p>
                    </div>
                </div>

                <!-- Добавление расхода -->
                <div class="add-expense-form compact">
                    <h3 class="section-title">Добавить расход</h3>
                    <div class="form-row compact">
                        <div class="form-col">
                            <div class="form-group floating-label compact">
                                <input type="number" id="expenseAmount" class="form-input" placeholder=" " required>
                                <label for="expenseAmount" class="floating-label-text">Сумма (₸)</label>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group floating-label compact">
                                <input type="date" id="expenseDate" class="form-input" required>
                                <label for="expenseDate" class="floating-label-text">Дата</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group compact">
                        <label>Категория</label>
                        <div class="category-options compact">
                            <div class="category-btn small" data-category="Еда" onclick="selectCategory('Еда')">
                                <div class="category-icon food small">
                                    <i class="fas fa-utensils"></i>
                                </div>
                                <span>Еда</span>
                            </div>
                            <div class="category-btn small" data-category="Транспорт" onclick="selectCategory('Транспорт')">
                                <div class="category-icon transport small">
                                    <i class="fas fa-bus"></i>
                                </div>
                                <span>Транспорт</span>
                            </div>
                            <div class="category-btn small" data-category="Учеба" onclick="selectCategory('Учеба')">
                                <div class="category-icon study small">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <span>Учеба</span>
                            </div>
                            <div class="category-btn small" data-category="Развлечения" onclick="selectCategory('Развлечения')">
                                <div class="category-icon entertainment small">
                                    <i class="fas fa-gamepad"></i>
                                </div>
                                <span>Развлечения</span>
                            </div>
                            <div class="category-btn small" data-category="Другое" onclick="selectCategory('Другое')">
                                <div class="category-icon other small">
                                    <i class="fas fa-ellipsis-h"></i>
                                </div>
                                <span>Другое</span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group floating-label compact">
                        <input type="text" id="expenseDescription" class="form-input" placeholder=" ">
                        <label for="expenseDescription" class="floating-label-text">Комментарий</label>
                    </div>
                    <button class="btn btn-primary small" onclick="addExpense()" style="width: 100%;">Добавить расход</button>
                </div>
            </div>

            <!-- Missions Page -->
            <div class="page missions-page" id="missions" style="display: none;">
                <div class="missions-header compact">
                    <h2>Миссии</h2>
                    <div class="missions-balance compact">
                        <div class="balance-info">
                            <i class="fas fa-coins"></i>
                            <div>
                                <div class="fincoins-text">Ваши FinCoins:</div>
                                <div class="fincoins-amount" id="fincoinsBalance">20</div>
                            </div>
                        </div>
                        <button class="btn btn-primary earn-btn small" onclick="showPage('store')">Магазин</button>
                    </div>
                </div>

                <!-- Активная миссия -->
                <div class="active-mission-section compact" id="activeMissionSection" style="display: none;">
                    <h3 class="section-title">Активная миссия</h3>
                    <div class="active-mission-card" id="activeMissionCard">
                        <!-- Активная миссия будет отображаться здесь -->
                    </div>
                </div>

                <!-- Доступные миссии -->
                <div class="missions-section compact">
                    <div class="section-header compact">
                        <div class="section-title">Доступные миссии</div>
                    </div>
                    <div class="missions-grid compact" id="missionsList">
                        <!-- Миссии будут добавляться динамически -->
                    </div>
                </div>

                <!-- Завершенные миссии -->
                <div class="missions-section compact">
                    <div class="section-header compact">
                        <div class="section-title">Завершенные миссии</div>
                    </div>
                    <div class="missions-grid compact" id="completedMissionsList">
                        <!-- Завершенные миссии будут добавляться динамически -->
                    </div>
                </div>
            </div>

            <!-- Store Page -->
            <div class="page store-page" id="store" style="display: none;">
                <div class="store-header compact">
                    <h2>Магазин</h2>
                    <div class="store-balance compact">
                        <div class="balance-info">
                            <i class="fas fa-coins"></i>
                            <div>
                                <div class="fincoins-text">Ваши FinCoins:</div>
                                <div class="fincoins-amount" id="storeBalance">20</div>
                            </div>
                        </div>
                        <button class="btn btn-primary earn-btn small" onclick="showPage('missions')">Заработать</button>
                    </div>
                </div>

                <!-- Премиум подписка -->
                <div class="store-category compact">
                    <h3 class="store-category-title">Премиум подписка</h3>
                    <div class="store-item compact">
                        <div class="store-item-header">
                            <div class="store-icon premium small">
                                <i class="fas fa-crown"></i>
                            </div>
                            <div class="store-title-container">
                                <div class="store-title">
                                    <span>FinanceMind Premium</span>
                                    <span class="premium-badge small">PREMIUM</span>
                                </div>
                                <div class="store-description">Получите доступ ко всем премиум-функциям</div>
                            </div>
                        </div>
                        <div class="store-features">
                            <div class="store-feature">
                                <i class="fas fa-chart-pie"></i>
                                <span>Расширенная аналитика</span>
                            </div>
                            <div class="store-feature">
                                <i class="fas fa-robot"></i>
                                <span>Персональный AI-коуч</span>
                            </div>
                            <div class="store-feature">
                                <i class="fas fa-palette"></i>
                                <span>Эксклюзивные темы</span>
                            </div>
                            <div class="store-feature">
                                <i class="fas fa-icons"></i>
                                <span>Набор иконок</span>
                            </div>
                        </div>
                        <div class="store-price">
                            <div class="fincoin-price">
                                <i class="fas fa-coins"></i>
                                <span class="price-amount">1500</span>
                            </div>
                            <button class="buy-btn premium small" onclick="buyPremiumSubscription()">Купить сейчас</button>
                        </div>
                    </div>
                </div>

                <!-- Другие товары -->
                <div class="store-category compact">
                    <h3 class="store-category-title">Премиум функции</h3>
                    
                    <div class="store-item compact">
                        <div class="store-item-header">
                            <div class="store-icon analytics small">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="store-title-container">
                                <div class="store-title">Расширенная аналитика</div>
                                <div class="store-description">Подробные отчеты и прогнозы расходов</div>
                            </div>
                        </div>
                        <div class="store-price">
                            <div class="fincoin-price">
                                <i class="fas fa-coins"></i>
                                <span class="price-amount">300</span>
                            </div>
                            <button class="buy-btn small" onclick="buyItem('extended_analytics', 300)">Купить</button>
                        </div>
                    </div>

                    <div class="store-item compact">
                        <div class="store-item-header">
                            <div class="store-icon ai small">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="store-title-container">
                                <div class="store-title">Персональный AI-коуч</div>
                                <div class="store-description">Индивидуальные финансовые рекомендации</div>
                            </div>
                        </div>
                        <div class="store-price">
                            <div class="fincoin-price">
                                <i class="fas fa-coins"></i>
                                <span class="price-amount">500</span>
                            </div>
                            <button class="buy-btn small" onclick="buyItem('ai_coach', 500)">Купить</button>
                        </div>
                    </div>

                    <div class="store-item compact">
                        <div class="store-item-header">
                            <div class="store-icon themes small">
                                <i class="fas fa-palette"></i>
                            </div>
                            <div class="store-title-container">
                                <div class="store-title">Эксклюзивные темы</div>
                                <div class="store-description">5 уникальных цветовых схем</div>
                            </div>
                        </div>
                        <div class="store-price">
                            <div class="fincoin-price">
                                <i class="fas fa-coins"></i>
                                <span class="price-amount">200</span>
                            </div>
                            <button class="buy-btn small" onclick="buyItem('themes_pack', 200)">Купить</button>
                        </div>
                    </div>

                    <div class="store-item compact">
                        <div class="store-item-header">
                            <div class="store-icon icons small">
                                <i class="fas fa-icons"></i>
                            </div>
                            <div class="store-title-container">
                                <div class="store-title">Набор иконок</div>
                                <div class="store-description">Стильные иконки для категорий</div>
                            </div>
                        </div>
                        <div class="store-price">
                            <div class="fincoin-price">
                                <i class="fas fa-coins"></i>
                                <span class="price-amount">150</span>
                            </div>
                            <button class="buy-btn small" onclick="buyItem('icon_pack', 150)">Купить</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Page (AI-помощник) -->
            <div class="page chat-page" id="chat" style="display: none;">
                <div class="chat-header">
                    <h2>AI Помощник</h2>
                    <div class="chat-subtitle">История чатов</div>
                </div>
                
                <div class="chat-messages-container" id="chatMessagesContainer">
                    <div class="chat-welcome">
                        <div class="welcome-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>Привет! Я ваш AI-помощник по финансам.</h3>
                        <p>Могу помочь с анализом расходов, советами по экономии и финансовым планированием.</p>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        <!-- Сообщения будут добавляться сюда -->
                    </div>
                </div>
                
                <div class="chat-input-section">
                    <div class="chat-input-container">
                        <input type="text" 
                               id="chatInput" 
                               class="chat-input" 
                               placeholder="Введите ваш вопрос..."
                               onkeypress="handleChatInput(event)">
                        <button class="chat-send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="chat-suggestions">
                        <button class="suggestion-btn" onclick="suggestQuestion('Анализ расходов')">
                            <i class="fas fa-chart-pie"></i> Анализ расходов
                        </button>
                        <button class="suggestion-btn" onclick="suggestQuestion('Советы по экономии')">
                            <i class="fas fa-piggy-bank"></i> Советы по экономии
                        </button>
                        <button class="suggestion-btn" onclick="suggestQuestion('Финансовое планирование')">
                            <i class="fas fa-calendar-alt"></i> Планирование
                        </button>
                    </div>
                </div>
            </div>

            <!-- Banks Page -->
            <div class="page banks-page" id="banks" style="display: none;">
                <div class="banks-container">
                    <div class="banks-header">
                        <h2>Банки</h2>
                        <p class="banks-subtitle">Управление подключенными банками</p>
                    </div>

                    <!-- Bank Connection Section -->
                    <div class="bank-connection-section">
                        <h3>Подключение банков</h3>
                        
                        <div class="bank-list">
                            <!-- Kaspi Bank -->
                            <div class="bank-item" id="kaspiBankItem">
                                <div class="bank-info">
                                    <div class="bank-logo kaspi">
                                        <i class="fas fa-building"></i>
                                    </div>
                                    <div class="bank-details">
                                        <h4>Kaspi Bank</h4>
                                        <div class="bank-status">
                                            <div class="status-dot disconnected"></div>
                                            <span class="status-text">Не подключено</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="connect-btn" onclick="connectBank('kaspi')">
                                    <i class="fas fa-plug"></i> Подключить
                                </button>
                            </div>

                            <!-- Halyk Bank -->
                            <div class="bank-item" id="halykBankItem">
                                <div class="bank-info">
                                    <div class="bank-logo halyk">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <div class="bank-details">
                                        <h4>Halyk Bank</h4>
                                        <div class="bank-status">
                                            <div class="status-dot disconnected"></div>
                                            <span class="status-text">Не подключено</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="connect-btn" onclick="connectBank('halyk')">
                                    <i class="fas fa-plug"></i> Подключить
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Analysis -->
                    <div class="quick-analysis-section">
                        <h3>Короткий разбор</h3>
                        <div class="analysis-content">
                            <p id="quickAnalysisText">Подключите банки, чтобы получить анализ ваших расходов</p>
                            <button class="analysis-btn" onclick="runQuickAnalysis()" id="quickAnalysisBtn">
                                <i class="fas fa-chart-bar"></i> Сделать разбор
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page settings-page" id="settings" style="display: none;">
                <!-- Профиль -->
                <div class="profile-header compact">
                    <div class="profile-avatar small" id="profileAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-info">
                        <div class="profile-name" id="profileName">Пользователь</div>
                        <div class="profile-email" id="profileEmail">user@example.com</div>
                        <div class="profile-role" id="profileRole">Пользователь</div>
                    </div>
                </div>

                <!-- Управление аккаунтом -->
                <div class="settings-section compact">
                    <h3 class="settings-section-title">Управление аккаунтом</h3>
                    
                    <div class="settings-item compact" onclick="openPersonalDataSection()">
                        <div class="settings-item-left">
                            <div class="settings-item-icon personal small">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="settings-item-content">
                                <div class="settings-item-label">Персональные данные</div>
                                <div class="settings-item-value">Личная информация</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    
                    <div class="settings-item compact" onclick="openSecuritySection()">
                        <div class="settings-item-left">
                            <div class="settings-item-icon security small">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="settings-item-content">
                                <div class="settings-item-label">Безопасность</div>
                                <div class="settings-item-value">Пароль и вход</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>

                    <!-- Управление подростковыми аккаунтами (только для родительского режима) -->
                    <div class="settings-item compact" id="parentControlsItem" style="display: none;" onclick="openTeenAccountsSection()">
                        <div class="settings-item-left">
                            <div class="settings-item-icon parent small">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="settings-item-content">
                                <div class="settings-item-label">Подростковые аккаунты</div>
                                <div class="settings-item-value">Контроль и отслеживание</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>

                    <!-- Семейные подключения -->
                    <div class="settings-item compact" onclick="openFamilyConnectionsSection()">
                        <div class="settings-item-left">
                            <div class="settings-item-icon family small">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="settings-item-content">
                                <div class="settings-item-label">Семейные подключения</div>
                                <div class="settings-item-value">Подключение детей</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>

                <!-- Язык и тема -->
                <div class="settings-section compact">
                    <h3 class="settings-section-title">Язык и тема</h3>
                    
                    <!-- Язык -->
                    <div class="language-selector compact">
                        <button class="lang-btn active" onclick="changeLanguage('ru')" data-lang="ru">
                            <i class="fas fa-check"></i>
                            <span>Русский</span>
                        </button>
                        <button class="lang-btn" onclick="changeLanguage('kz')" data-lang="kz">
                            <i class="fas fa-check"></i>
                            <span>Қазақша</span>
                        </button>
                        <button class="lang-btn" onclick="changeLanguage('en')" data-lang="en">
                            <i class="fas fa-check"></i>
                            <span>English</span>
                        </button>
                    </div>
                    
                    <!-- Тема -->
                    <div class="theme-selector compact" id="themeSelector">
                        <button class="theme-btn active small" onclick="changeTheme('light')" title="Светлая тема">
                            <i class="fas fa-sun"></i>
                        </button>
                        <button class="theme-btn small" onclick="changeTheme('dark')" title="Тёмная тема">
                            <i class="fas fa-moon"></i>
                        </button>
                        <button class="theme-btn small" onclick="changeTheme('auto')" title="Системная тема">
                            <i class="fas fa-desktop"></i>
                        </button>
                    </div>
                </div>

                <!-- Выход -->
                <button class="logout-btn compact" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Выйти</span>
                </button>
            </div>

            <!-- Admin Panel -->
            <div class="page admin-page" id="adminPanel" style="display: none;">
                <div class="admin-header compact">
                    <h1 class="admin-title">Админ панель</h1>
                </div>

                <div class="admin-stats compact">
                    <div class="admin-stat-card compact">
                        <div class="admin-stat-icon users small">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="admin-stat-value" id="totalUsers">0</div>
                        <div class="admin-stat-label">Пользователи</div>
                    </div>
                    <div class="admin-stat-card compact">
                        <div class="admin-stat-icon missions small">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="admin-stat-value" id="totalMissions">0</div>
                        <div class="admin-stat-label">Миссии</div>
                    </div>
                    <div class="admin-stat-card compact">
                        <div class="admin-stat-icon completed small">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="admin-stat-value" id="completedMissions">0</div>
                        <div class="admin-stat-label">Выполнено</div>
                    </div>
                    <div class="admin-stat-card compact">
                        <div class="admin-stat-icon coins small">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="admin-stat-value" id="totalFincoins">0</div>
                        <div class="admin-stat-label">FinCoins</div>
                    </div>
                </div>

                <div class="admin-section compact">
                    <h3 class="admin-section-title">Управление миссиями</h3>
                    <div class="mission-management compact" id="missionManagement">
                        <!-- Миссии для управления будут добавляться динамически -->
                    </div>
                </div>

                <div class="admin-section compact">
                    <h3 class="admin-section-title">Прогресс пользователей</h3>
                    <div class="user-progress compact" id="userProgress">
                        <!-- Прогресс пользователей будет добавляться динамически -->
                    </div>
                </div>

                <div class="admin-section compact">
                    <h3 class="admin-section-title">Отчеты</h3>
                    <div class="reports-actions compact">
                        <button class="btn btn-primary small" onclick="generateMonthlyReport()" style="width: 100%; margin-bottom: 8px;">
                            <i class="fas fa-file-alt"></i>
                            <span>Месячный отчет</span>
                        </button>
                        <button class="btn btn-primary small" onclick="generateDetailedReport()" style="width: 100%;">
                            <i class="fas fa-chart-bar"></i>
                            <span>Обширный отчет</span>
                        </button>
                    </div>
                </div>

                <button class="btn btn-primary small" onclick="exportAllData()" style="width: 100%; margin-top: 16px;">
                    <i class="fas fa-download"></i>
                    <span>Экспорт данных</span>
                </button>
            </div>
        </div>

        <!-- Bottom Navigation - Only shown after login - 5 панелей -->
        <div class="bottom-nav" id="bottomNav" style="display: none;">
            <a href="#" class="nav-item active" onclick="showPage('dashboard')">
                <div class="nav-icon">
                    <i class="fas fa-home"></i>
                </div>
                <div class="nav-label">Главная</div>
            </a>
            <a href="#" class="nav-item" onclick="showPage('analytics')">
                <div class="nav-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <div class="nav-label">Аналитика</div>
            </a>
            <a href="#" class="nav-item" onclick="showPage('missions')">
                <div class="nav-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="nav-label">Миссии</div>
            </a>
            <a href="#" class="nav-item" onclick="showPage('chat')">
                <div class="nav-icon">
                    <i class="fas fa-comments"></i>
                </div>
                <div class="nav-label">Помощник</div>
            </a>
            <a href="#" class="nav-item" onclick="showPage('banks')">
                <div class="nav-icon">
                    <i class="fas fa-university"></i>
                </div>
                <div class="nav-label">Банки</div>
            </a>
        </div>
    </div>

    <!-- Modal for Adding Goals -->
    <div class="modal-overlay" id="goalModal" style="display: none;">
        <div class="modal-content compact">
            <div class="modal-header compact">
                <h3 class="modal-title">Добавить цель</h3>
                <button class="modal-close small" onclick="closeGoalModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group floating-label compact">
                <input type="text" id="goalName" class="form-input" placeholder=" " required>
                <label for="goalName" class="floating-label-text">Название цели</label>
            </div>
            <div class="form-group floating-label compact">
                <input type="number" id="goalAmount" class="form-input" placeholder=" " required>
                <label for="goalAmount" class="floating-label-text">Сумма цели (₸)</label>
            </div>
            <div class="form-group floating-label compact">
                <input type="number" id="goalCurrent" class="form-input" placeholder=" " value="0" required>
                <label for="goalCurrent" class="floating-label-text">Текущая сумма (₸)</label>
            </div>
            <div class="form-group floating-label compact">
                <input type="date" id="goalDeadline" class="form-input" required>
                <label for="goalDeadline" class="floating-label-text">Срок цели</label>
            </div>
            <button class="btn btn-primary small" onclick="addNewGoal()" style="width: 100%;">
                <i class="fas fa-plus"></i>
                <span>Добавить</span>
            </button>
        </div>
    </div>

    <!-- Instruction Modal -->
    <div class="modal-overlay" id="instructionModal" style="display: none;">
        <div class="modal-content compact">
            <div class="modal-header compact">
                <h3 class="modal-title">Инструкция FinanceMind</h3>
                <button class="modal-close small" onclick="closeInstructionModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="instruction-content compact">
                <p><strong>Добро пожаловать в FinanceMind!</strong></p>
                <p>Эта инструкция поможет вам быстро освоиться в приложении.</p>
                
                <div class="instruction-section compact">
                    <h4><i class="fas fa-home"></i> <span>1. Главный экран</span></h4>
                    <ul>
                        <li>Просматривайте статистику расходов</li>
                        <li>Получайте AI-советы</li>
                        <li>Управляйте финансовыми целями</li>
                    </ul>
                </div>

                <div class="instruction-section compact">
                    <h4><i class="fas fa-chart-line"></i> <span>2. Аналитика</span></h4>
                    <ul>
                        <li>Анализируйте графики расходов</li>
                        <li>Добавляйте новые расходы</li>
                        <li>Просматривайте историю трат</li>
                    </ul>
                </div>

                <div class="instruction-section compact">
                    <h4><i class="fas fa-trophy"></i> <span>3. Миссии</span></h4>
                    <ul>
                        <li>Выполняйте задания</li>
                        <li>Зарабатывайте FinCoins</li>
                        <li>Отслеживайте прогресс</li>
                    </ul>
                </div>

                <div class="instruction-section compact">
                    <h4><i class="fas fa-university"></i> <span>4. Банки</span></h4>
                    <ul>
                        <li>Подключайте банковские счета</li>
                        <li>Синхронизируйте транзакции</li>
                        <li>Анализируйте банковские операции</li>
                    </ul>
                </div>

                <div class="instruction-section compact">
                    <h4><i class="fas fa-comments"></i> <span>5. AI-помощник</span></h4>
                    <ul>
                        <li>Получайте финансовые советы</li>
                        <li>Задавайте вопросы</li>
                    </ul>
                </div>
            </div>
            <div style="display: flex; justify-content: center; margin-top: 16px;">
                <button class="btn btn-primary small" onclick="closeInstructionModal()">
                    <span>Понятно</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div class="modal-overlay" id="reportModal" style="display: none;">
        <div class="modal-content compact">
            <div class="modal-header compact">
                <h3 class="modal-title" id="reportModalTitle">Отчет</h3>
                <button class="modal-close small" onclick="closeReportModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="report-content compact" id="reportContent">
                <!-- Содержание отчета будет здесь -->
            </div>
            <div class="report-actions compact">
                <button class="btn btn-outline small" onclick="shareReport()">
                    <i class="fas fa-share"></i>
                    <span>Поделиться</span>
                </button>
                <button class="btn btn-primary small" onclick="downloadReport()">
                    <i class="fas fa-download"></i>
                    <span>Скачать</span>
                </button>
                <button class="btn btn-secondary small" onclick="closeReportModal()">
                    <i class="fas fa-times"></i>
                    <span>Закрыть</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Calendar Modal -->
    <div class="modal-overlay" id="calendarModal" style="display: none;">
        <div class="modal-content compact">
            <div class="modal-header compact">
                <h3 class="modal-title">Календарь</h3>
                <button class="modal-close small" onclick="closeCalendarModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="calendar-nav-btn" onclick="changeCalendarMonth(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="calendar-month-year" id="calendarMonthYear"></div>
                    <button class="calendar-nav-btn" onclick="changeCalendarMonth(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="calendar-weekdays">
                    <div>Пн</div>
                    <div>Вт</div>
                    <div>Ср</div>
                    <div>Чт</div>
                    <div>Пт</div>
                    <div>Сб</div>
                    <div>Вс</div>
                </div>
                <div class="calendar-days" id="calendarDays"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Функции для навигации между страницами
        function showAccountTypePage() {
            document.getElementById('accountTypePage').style.display = 'block';
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('appHeader').style.display = 'none';
            document.getElementById('bottomNav').style.display = 'none';
        }
        
        function showLoginPage() {
            document.getElementById('accountTypePage').style.display = 'none';
            document.getElementById('authPage').style.display = 'block';
        }
        
        function selectAccountType(type) {
            // Здесь будет логика выбора типа аккаунта
            console.log('Выбран тип аккаунта:', type);
            // После выбора типа можно показать форму входа
            showLoginPage();
        }
        
        function login() {
            // Базовая логика входа
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                showNotification('Введите email и пароль', 'error');
                return;
            }
            
            // Имитация успешного входа
            showNotification('Вход выполнен успешно', 'success');
            
            // Показать основное приложение
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('appHeader').style.display = 'flex';
            document.getElementById('bottomNav').style.display = 'flex';
            showPage('dashboard');
        }
        
        function showPage(pageName) {
            // Скрыть все страницы
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.style.display = 'none';
            });
            
            // Показать выбранную страницу
            document.getElementById(pageName).style.display = 'block';
            
            // Обновить заголовок
            const titleMap = {
                'dashboard': 'Главная',
                'analytics': 'Аналитика',
                'missions': 'Миссии',
                'chat': 'Помощник',
                'banks': 'Банки',
                'store': 'Магазин',
                'settings': 'Настройки',
                'adminPanel': 'Админ панель'
            };
            
            document.getElementById('headerTitle').textContent = titleMap[pageName] || 'Главная';
            
            // Обновить активную навигацию
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (pageName !== 'store' && pageName !== 'settings' && pageName !== 'adminPanel') {
                const activeNav = document.querySelector(`.nav-item[onclick*="${pageName}"]`);
                if (activeNav) {
                    activeNav.classList.add('active');
                }
            }
        }
        
        function logout() {
            // Вернуться на страницу выбора типа аккаунта
            document.getElementById('appHeader').style.display = 'none';
            document.getElementById('bottomNav').style.display = 'none';
            showAccountTypePage();
            showNotification('Вы вышли из системы', 'info');
        }
        
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            // Автоматическое удаление через 5 секунд
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const button = input.parentElement.querySelector('.toggle-password i');
            
            if (input.type === 'password') {
                input.type = 'text';
                button.classList.remove('fa-eye');
                button.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                button.classList.remove('fa-eye-slash');
                button.classList.add('fa-eye');
            }
        }
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Установить текущую дату в поле даты
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('expenseDate');
            if (dateInput) {
                dateInput.value = today;
            }
            
            // Установить дату дедлайна цели на месяц вперед
            const goalDeadline = document.getElementById('goalDeadline');
            if (goalDeadline) {
                const futureDate = new Date();
                futureDate.setMonth(futureDate.getMonth() + 1);
                goalDeadline.value = futureDate.toISOString().split('T')[0];
            }
            
            // Показать страницу выбора типа аккаунта по умолчанию
            showAccountTypePage();
        });
    </script>
</body>
</html>
